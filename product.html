<!DOCTYPE html>
<html>
<head>
  <title>Product Details | Tetra Tech</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<div class="container my-5">
  <div class="row">

    <!-- Images -->
    <div class="col-md-6">
      <img id="mainImg" class="img-fluid rounded shadow mb-3">
    </div>

    <!-- Details -->
    <div class="col-md-6">
      <h2 id="appName"></h2>
      <p id="appDesc" class="text-muted"></p>

      <h4 class="text-success" id="appPrice"></h4>

      <h5 class="mt-4">Features</h5>
      <ul id="features"></ul>

      <button class="btn btn-primary mt-3"
        onclick="buyNow()">
        Buy Now
      </button>
    </div>

  </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
<script src="js/firebase.js"></script>

<script>
const params = new URLSearchParams(window.location.search);
const appId = params.get("id");
let selectedApp;

firebase.firestore().collection("apps").doc(appId).get()
.then(doc => {
  selectedApp = doc.data();

  document.getElementById("appName").innerText = selectedApp.name;
  document.getElementById("appDesc").innerText = selectedApp.desc;
  document.getElementById("appPrice").innerText = "â‚¹" + selectedApp.price;

  document.getElementById("mainImg").src = selectedApp.images[0];

  let featuresHTML = "";
  selectedApp.features.forEach(f => {
    featuresHTML += `<li>${f}</li>`;
  });
  document.getElementById("features").innerHTML = featuresHTML;
});

function buyNow() {
  if (!firebase.auth().currentUser) {
    window.location.href = "login.html";
  } else {
    window.location.href = "checkout.html?id=" + appId;
  }
}
</script>

</body>
</html>
